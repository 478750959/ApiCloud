/*
 A JavaScript implementation of the SHA family of hashes, as
 defined in FIPS PUB 180-2 as well as the corresponding HMAC implementation
 as defined in FIPS PUB 198a

 Copyright Brian Turek 2008-2014
 Distributed under the BSD License
 See http://caligatio.github.com/jsSHA/ for more information

 Several functions taken from Paul Johnston
*/
'use strict';(function(U){function y(a,c,b){var e=0,g=[0],h="",k=null,h=b||"UTF8";if("UTF8"!==h&&"UTF16"!==h)throw"encoding must be UTF8 or UTF16";if("HEX"===c){if(0!==a.length%2)throw"srcString of HEX type must be in byte increments";k=C(a);e=k.binLen;g=k.value}else if("TEXT"===c)k=L(a,h),e=k.binLen,g=k.value;else if("B64"===c)k=M(a),e=k.binLen,g=k.value;else if("BYTES"===c)k=N(a),e=k.binLen,g=k.value;else throw"inputFormat must be HEX, TEXT, B64, or BYTES";this.getHash=function(a,c,b,h){var k=null,
d=g.slice(),n=e,m;3===arguments.length?"number"!==typeof b&&(h=b,b=1):2===arguments.length&&(b=1);if(b!==parseInt(b,10)||1>b)throw"numRounds must a integer >= 1";switch(c){case "HEX":k=O;break;case "B64":k=P;break;case "BYTES":k=Q;break;default:throw"format must be HEX, B64, or BYTES";}if("SHA-1"===a)for(m=0;m<b;m+=1)d=z(d,n),n=160;else if("SHA-224"===a)for(m=0;m<b;m+=1)d=w(d,n,a),n=224;else if("SHA-256"===a)for(m=0;m<b;m+=1)d=w(d,n,a),n=256;else if("SHA-384"===a)for(m=0;m<b;m+=1)d=w(d,n,a),n=384;
else if("SHA-512"===a)for(m=0;m<b;m+=1)d=w(d,n,a),n=512;else throw"Chosen SHA variant is not supported";return k(d,R(h))};this.getHMAC=function(a,b,c,k,u){var d,n,m,r,p=[],s=[];d=null;switch(k){case "HEX":k=O;break;case "B64":k=P;break;case "BYTES":k=Q;break;default:throw"outputFormat must be HEX, B64, or BYTES";}if("SHA-1"===c)n=64,r=160;else if("SHA-224"===c)n=64,r=224;else if("SHA-256"===c)n=64,r=256;else if("SHA-384"===c)n=128,r=384;else if("SHA-512"===c)n=128,r=512;else throw"Chosen SHA variant is not supported";
if("HEX"===b)d=C(a),m=d.binLen,d=d.value;else if("TEXT"===b)d=L(a,h),m=d.binLen,d=d.value;else if("B64"===b)d=M(a),m=d.binLen,d=d.value;else if("BYTES"===b)d=N(a),m=d.binLen,d=d.value;else throw"inputFormat must be HEX, TEXT, B64, or BYTES";a=8*n;b=n/4-1;n<m/8?(d="SHA-1"===c?z(d,m):w(d,m,c),d[b]&=4294967040):n>m/8&&(d[b]&=4294967040);for(n=0;n<=b;n+=1)p[n]=d[n]^909522486,s[n]=d[n]^1549556828;c="SHA-1"===c?z(s.concat(z(p.concat(g),a+e)),a+r):w(s.concat(w(p.concat(g),a+e,c)),a+r,c);return k(c,R(u))}}
function u(a,c){this.a=a;this.b=c}function L(a,c){var b=[],e,g=[],h=0,k;if("UTF8"===c)for(k=0;k<a.length;k+=1)for(e=a.charCodeAt(k),g=[],128>e?g.push(e):2048>e?(g.push(192|e>>>6),g.push(128|e&63)):55296>e||57344<=e?g.push(224|e>>>12,128|e>>>6&63,128|e&63):(k+=1,e=65536+((e&1023)<<10|a.charCodeAt(k)&1023),g.push(240|e>>>18,128|e>>>12&63,128|e>>>6&63,128|e&63)),e=0;e<g.length;e+=1)(h>>>2)+1>b.length&&b.push(0),b[h>>>2]|=g[e]<<24-h%4*8,h+=1;else if("UTF16"===c)for(k=0;k<a.length;k+=1)(h>>>2)+1>b.length&&
b.push(0),b[h>>>2]|=a.charCodeAt(k)<<16-h%4*8,h+=2;return{value:b,binLen:8*h}}function C(a){var c=[],b=a.length,e,g;if(0!==b%2)throw"String of HEX type must be in byte increments";for(e=0;e<b;e+=2){g=parseInt(a.substr(e,2),16);if(isNaN(g))throw"String of HEX type contains invalid characters";c[e>>>3]|=g<<24-e%8*4}return{value:c,binLen:4*b}}function N(a){var c=[],b,e;for(e=0;e<a.length;e+=1)b=a.charCodeAt(e),(e>>>2)+1>c.length&&c.push(0),c[e>>>2]|=b<<24-e%4*8;return{value:c,binLen:8*a.length}}function M(a){var c=
[],b=0,e,g,h,k,t;if(-1===a.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";e=a.indexOf("=");a=a.replace(/\=/g,"");if(-1!==e&&e<a.length)throw"Invalid '=' found in base-64 string";for(g=0;g<a.length;g+=4){t=a.substr(g,4);for(h=k=0;h<t.length;h+=1)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t[h]),k|=e<<18-6*h;for(h=0;h<t.length-1;h+=1)c[b>>2]|=(k>>>16-8*h&255)<<24-b%4*8,b+=1}return{value:c,binLen:8*b}}function O(a,c){var b="",e=4*a.length,g,h;
for(g=0;g<e;g+=1)h=a[g>>>2]>>>8*(3-g%4),b+="0123456789abcdef".charAt(h>>>4&15)+"0123456789abcdef".charAt(h&15);return c.outputUpper?b.toUpperCase():b}function P(a,c){var b="",e=4*a.length,g,h,k;for(g=0;g<e;g+=3)for(k=(a[g>>>2]>>>8*(3-g%4)&255)<<16|(a[g+1>>>2]>>>8*(3-(g+1)%4)&255)<<8|a[g+2>>>2]>>>8*(3-(g+2)%4)&255,h=0;4>h;h+=1)b=8*g+6*h<=32*a.length?b+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>>6*(3-h)&63):b+c.b64Pad;return b}function Q(a){var c="",b=4*a.length,e,
g;for(e=0;e<b;e+=1)g=a[e>>>2]>>>8*(3-e%4)&255,c+=String.fromCharCode(g);return c}function R(a){var c={outputUpper:!1,b64Pad:"="};try{a.hasOwnProperty("outputUpper")&&(c.outputUpper=a.outputUpper),a.hasOwnProperty("b64Pad")&&(c.b64Pad=a.b64Pad)}catch(b){}if("boolean"!==typeof c.outputUpper)throw"Invalid outputUpper formatting option";if("string"!==typeof c.b64Pad)throw"Invalid b64Pad formatting option";return c}function x(a,c){return a<<c|a>>>32-c}function p(a,c){return a>>>c|a<<32-c}function s(a,
c){var b=null,b=new u(a.a,a.b);return b=32>=c?new u(b.a>>>c|b.b<<32-c&4294967295,b.b>>>c|b.a<<32-c&4294967295):new u(b.b>>>c-32|b.a<<64-c&4294967295,b.a>>>c-32|b.b<<64-c&4294967295)}function S(a,c){var b=null;return b=32>=c?new u(a.a>>>c,a.b>>>c|a.a<<32-c&4294967295):new u(0,a.a>>>c-32)}function V(a,c,b){return a&c^~a&b}function W(a,c,b){return new u(a.a&c.a^~a.a&b.a,a.b&c.b^~a.b&b.b)}function T(a,c,b){return a&c^a&b^c&b}function X(a,c,b){return new u(a.a&c.a^a.a&b.a^c.a&b.a,a.b&c.b^a.b&b.b^c.b&b.b)}
function Y(a){return p(a,2)^p(a,13)^p(a,22)}function Z(a){var c=s(a,28),b=s(a,34);a=s(a,39);return new u(c.a^b.a^a.a,c.b^b.b^a.b)}function $(a){return p(a,6)^p(a,11)^p(a,25)}function aa(a){var c=s(a,14),b=s(a,18);a=s(a,41);return new u(c.a^b.a^a.a,c.b^b.b^a.b)}function ba(a){return p(a,7)^p(a,18)^a>>>3}function ca(a){var c=s(a,1),b=s(a,8);a=S(a,7);return new u(c.a^b.a^a.a,c.b^b.b^a.b)}function da(a){return p(a,17)^p(a,19)^a>>>10}function ea(a){var c=s(a,19),b=s(a,61);a=S(a,6);return new u(c.a^b.a^
a.a,c.b^b.b^a.b)}function A(a,c){var b=(a&65535)+(c&65535);return((a>>>16)+(c>>>16)+(b>>>16)&65535)<<16|b&65535}function fa(a,c,b,e){var g=(a&65535)+(c&65535)+(b&65535)+(e&65535);return((a>>>16)+(c>>>16)+(b>>>16)+(e>>>16)+(g>>>16)&65535)<<16|g&65535}function D(a,c,b,e,g){var h=(a&65535)+(c&65535)+(b&65535)+(e&65535)+(g&65535);return((a>>>16)+(c>>>16)+(b>>>16)+(e>>>16)+(g>>>16)+(h>>>16)&65535)<<16|h&65535}function ga(a,c){var b,e,g;b=(a.b&65535)+(c.b&65535);e=(a.b>>>16)+(c.b>>>16)+(b>>>16);g=(e&65535)<<
16|b&65535;b=(a.a&65535)+(c.a&65535)+(e>>>16);e=(a.a>>>16)+(c.a>>>16)+(b>>>16);return new u((e&65535)<<16|b&65535,g)}function ha(a,c,b,e){var g,h,k;g=(a.b&65535)+(c.b&65535)+(b.b&65535)+(e.b&65535);h=(a.b>>>16)+(c.b>>>16)+(b.b>>>16)+(e.b>>>16)+(g>>>16);k=(h&65535)<<16|g&65535;g=(a.a&65535)+(c.a&65535)+(b.a&65535)+(e.a&65535)+(h>>>16);h=(a.a>>>16)+(c.a>>>16)+(b.a>>>16)+(e.a>>>16)+(g>>>16);return new u((h&65535)<<16|g&65535,k)}function ia(a,c,b,e,g){var h,k,t;h=(a.b&65535)+(c.b&65535)+(b.b&65535)+(e.b&
65535)+(g.b&65535);k=(a.b>>>16)+(c.b>>>16)+(b.b>>>16)+(e.b>>>16)+(g.b>>>16)+(h>>>16);t=(k&65535)<<16|h&65535;h=(a.a&65535)+(c.a&65535)+(b.a&65535)+(e.a&65535)+(g.a&65535)+(k>>>16);k=(a.a>>>16)+(c.a>>>16)+(b.a>>>16)+(e.a>>>16)+(g.a>>>16)+(h>>>16);return new u((k&65535)<<16|h&65535,t)}function z(a,c){var b=[],e,g,h,k,t,u,p,q,s,d=[1732584193,4023233417,2562383102,271733878,3285377520];a[c>>>5]|=128<<24-c%32;a[(c+65>>>9<<4)+15]=c;s=a.length;for(p=0;p<s;p+=16){e=d[0];g=d[1];h=d[2];k=d[3];t=d[4];for(q=
0;80>q;q+=1)b[q]=16>q?a[q+p]:x(b[q-3]^b[q-8]^b[q-14]^b[q-16],1),u=20>q?D(x(e,5),g&h^~g&k,t,1518500249,b[q]):40>q?D(x(e,5),g^h^k,t,1859775393,b[q]):60>q?D(x(e,5),T(g,h,k),t,2400959708,b[q]):D(x(e,5),g^h^k,t,3395469782,b[q]),t=k,k=h,h=x(g,30),g=e,e=u;d[0]=A(e,d[0]);d[1]=A(g,d[1]);d[2]=A(h,d[2]);d[3]=A(k,d[3]);d[4]=A(t,d[4])}return d}function w(a,c,b){var e,g,h,k,t,p,s,q,w,d,n,m,r,x,y,v,z,E,F,G,H,I,J,K,f,B=[],C,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,
3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,
1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];d=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];g=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if("SHA-224"===b||"SHA-256"===b)n=64,e=(c+65>>>9<<4)+15,x=16,y=1,f=Number,v=A,z=fa,E=D,F=ba,G=da,H=Y,I=$,K=T,J=V,d="SHA-224"===b?d:g;else if("SHA-384"===b||"SHA-512"===b)n=80,e=(c+128>>>10<<5)+31,x=32,y=2,f=u,v=ga,z=ha,E=
ia,F=ca,G=ea,H=Z,I=aa,K=X,J=W,l=[new f(l[0],3609767458),new f(l[1],602891725),new f(l[2],3964484399),new f(l[3],2173295548),new f(l[4],4081628472),new f(l[5],3053834265),new f(l[6],2937671579),new f(l[7],3664609560),new f(l[8],2734883394),new f(l[9],1164996542),new f(l[10],1323610764),new f(l[11],3590304994),new f(l[12],4068182383),new f(l[13],991336113),new f(l[14],633803317),new f(l[15],3479774868),new f(l[16],2666613458),new f(l[17],944711139),new f(l[18],2341262773),new f(l[19],2007800933),new f(l[20],
1495990901),new f(l[21],1856431235),new f(l[22],3175218132),new f(l[23],2198950837),new f(l[24],3999719339),new f(l[25],766784016),new f(l[26],2566594879),new f(l[27],3203337956),new f(l[28],1034457026),new f(l[29],2466948901),new f(l[30],3758326383),new f(l[31],168717936),new f(l[32],1188179964),new f(l[33],1546045734),new f(l[34],1522805485),new f(l[35],2643833823),new f(l[36],2343527390),new f(l[37],1014477480),new f(l[38],1206759142),new f(l[39],344077627),new f(l[40],1290863460),new f(l[41],
3158454273),new f(l[42],3505952657),new f(l[43],106217008),new f(l[44],3606008344),new f(l[45],1432725776),new f(l[46],1467031594),new f(l[47],851169720),new f(l[48],3100823752),new f(l[49],1363258195),new f(l[50],3750685593),new f(l[51],3785050280),new f(l[52],3318307427),new f(l[53],3812723403),new f(l[54],2003034995),new f(l[55],3602036899),new f(l[56],1575990012),new f(l[57],1125592928),new f(l[58],2716904306),new f(l[59],442776044),new f(l[60],593698344),new f(l[61],3733110249),new f(l[62],2999351573),
new f(l[63],3815920427),new f(3391569614,3928383900),new f(3515267271,566280711),new f(3940187606,3454069534),new f(4118630271,4000239992),new f(116418474,1914138554),new f(174292421,2731055270),new f(289380356,3203993006),new f(460393269,320620315),new f(685471733,587496836),new f(852142971,1086792851),new f(1017036298,365543100),new f(1126000580,2618297676),new f(1288033470,3409855158),new f(1501505948,4234509866),new f(1607167915,987167468),new f(1816402316,1246189591)],d="SHA-384"===b?[new f(3418070365,
d[0]),new f(1654270250,d[1]),new f(2438529370,d[2]),new f(355462360,d[3]),new f(1731405415,d[4]),new f(41048885895,d[5]),new f(3675008525,d[6]),new f(1203062813,d[7])]:[new f(g[0],4089235720),new f(g[1],2227873595),new f(g[2],4271175723),new f(g[3],1595750129),new f(g[4],2917565137),new f(g[5],725511199),new f(g[6],4215389547),new f(g[7],327033209)];else throw"Unexpected error in SHA-2 implementation";a[c>>>5]|=128<<24-c%32;a[e]=c;C=a.length;for(m=0;m<C;m+=x){c=d[0];e=d[1];g=d[2];h=d[3];k=d[4];t=
d[5];p=d[6];s=d[7];for(r=0;r<n;r+=1)B[r]=16>r?new f(a[r*y+m],a[r*y+m+1]):z(G(B[r-2]),B[r-7],F(B[r-15]),B[r-16]),q=E(s,I(k),J(k,t,p),l[r],B[r]),w=v(H(c),K(c,e,g)),s=p,p=t,t=k,k=v(h,q),h=g,g=e,e=c,c=v(q,w);d[0]=v(c,d[0]);d[1]=v(e,d[1]);d[2]=v(g,d[2]);d[3]=v(h,d[3]);d[4]=v(k,d[4]);d[5]=v(t,d[5]);d[6]=v(p,d[6]);d[7]=v(s,d[7])}if("SHA-224"===b)a=[d[0],d[1],d[2],d[3],d[4],d[5],d[6]];else if("SHA-256"===b)a=d;else if("SHA-384"===b)a=[d[0].a,d[0].b,d[1].a,d[1].b,d[2].a,d[2].b,d[3].a,d[3].b,d[4].a,d[4].b,
d[5].a,d[5].b];else if("SHA-512"===b)a=[d[0].a,d[0].b,d[1].a,d[1].b,d[2].a,d[2].b,d[3].a,d[3].b,d[4].a,d[4].b,d[5].a,d[5].b,d[6].a,d[6].b,d[7].a,d[7].b];else throw"Unexpected error in SHA-2 implementation";return a}"function"===typeof define&&define.amd?define(function(){return y}):"undefined"!==typeof exports?"undefined"!==typeof module&&module.exports?module.exports=exports=y:exports=y:U.jsSHA=y})(this);
