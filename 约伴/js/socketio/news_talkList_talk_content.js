connUrl="http://172.18.147.84:8888";connOptions={};currentUserId="tiger";currentClientId="";currentRoomId="1";socket=io.connect(connUrl,connOptions);socket.on("connect",function(obj){var msg_json={};msg_json.room=currentRoomId;msg_json.client=currentClientId;msg_json.userId=currentUserId;msg_json.data="\u5927\u5bb6\u597d\uff0c\u6211\u6765\u4e86\u3002";socket.emit("roomNotice",msg_json)});
socket.on("disconnect",function(obj){var msg_json={};msg_json.room=currentRoomId;msg_json.client=currentClientId;msg_json.userId=currentUserId;msg_json.data=currentClientId+"\u9000\u51fa\u3002\u3010\u6389\u7ebf\u3011";socket.emit("roomQuit",msg_json)});socket.on("clientId",function(obj){currentClientId=obj.id});socket.on("news",function(obj){showMsg(obj)});
function showMsg(msg){if(msg==undefined)return;var userId=msg.userId;var userOther="0";if(userId==currentUserId)userOther="1";var msg_json='{"userOther":"'+userOther+'","userName":"'+userId+'","msgTime":"1\u5c0f\u65f6","msg":"'+msg.data+'"}';setLocVal("msg_json",msg_json);uexWindow.evaluatePopoverScript("news_talkList_talk","content","showMsg()")}
function sendMsg(){var chat_content=document.getElementById("chat_content");var msg_json={};msg_json.room=currentRoomId;msg_json.client=currentClientId;msg_json.userId=currentUserId;msg_json.data=chat_content.value;socket.emit("news",msg_json);chat_content.value=""};