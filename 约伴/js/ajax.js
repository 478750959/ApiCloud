function Ajax(recvType,waitId){var aj=new Object;aj.loading="\ufffd\ufffd\ufffd\u053a\ufffd...";aj.recvType=recvType?recvType:"XML";aj.waitId=waitId?$(waitId):null;aj.resultHandle=null;aj.sendString="";aj.targetUrl="";aj.setLoading=function(loading){if(typeof loading!=="undefined"&&loading!==null)aj.loading=loading};aj.setRecvType=function(recvtype){aj.recvType=recvtype};aj.setWaitId=function(waitid){aj.waitId=typeof waitid=="object"?waitid:$(waitid)};aj.createXMLHttpRequest=function(){var request=
false;if(window.XMLHttpRequest){request=new XMLHttpRequest;if(request.overrideMimeType)request.overrideMimeType("text/xml")}else if(window.ActiveXObject){var versions=["Microsoft.XMLHTTP","MSXML.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.7.0","Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.5.0","Msxml2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP"];for(var i=0;i<versions.length;i++)try{request=new ActiveXObject(versions[i]);if(request)return request}catch(e){}}return request};aj.XMLHttpRequest=aj.createXMLHttpRequest();
aj.showLoading=function(){if(aj.waitId&&(aj.XMLHttpRequest.readyState!=4||aj.XMLHttpRequest.status!=200)){aj.waitId.style.display="";aj.waitId.innerHTML='\x3cspan\x3e\x3cimg src\x3d"'+IMGDIR+'/loading.gif" class\x3d"vm"\x3e '+aj.loading+"\x3c/span\x3e"}};aj.processHandle=function(){if(aj.XMLHttpRequest.readyState==4&&aj.XMLHttpRequest.status==200){if(aj.waitId)aj.waitId.style.display="none";if(aj.recvType=="HTML")aj.resultHandle(aj.XMLHttpRequest.responseText,aj);else if(aj.recvType=="XML")if(!aj.XMLHttpRequest.responseXML||
!aj.XMLHttpRequest.responseXML.lastChild||aj.XMLHttpRequest.responseXML.lastChild.localName=="parsererror")aj.resultHandle('\x3ca href\x3d"'+aj.targetUrl+'" target\x3d"_blank" style\x3d"color:red"\x3e\ufffd\u06b2\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u07b7\ufffd\ufffd\ufffd\u02be\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\x3c/a\x3e',aj);else aj.resultHandle(aj.XMLHttpRequest.responseXML.lastChild.firstChild.nodeValue,aj)}};aj.get=function(targetUrl,resultHandle){setTimeout(function(){aj.showLoading()},250);
aj.targetUrl=targetUrl;aj.XMLHttpRequest.onreadystatechange=aj.processHandle;aj.resultHandle=resultHandle;var attackevasive=isUndefined(attackevasive)?0:attackevasive;if(window.XMLHttpRequest){aj.XMLHttpRequest.open("GET",aj.targetUrl);aj.XMLHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest");aj.XMLHttpRequest.send(null)}else{aj.XMLHttpRequest.open("GET",targetUrl,true);aj.XMLHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest");aj.XMLHttpRequest.send()}};aj.post=function(targetUrl,
sendString,resultHandle){targetUrl=hostconvert(targetUrl);setTimeout(function(){aj.showLoading()},250);aj.targetUrl=targetUrl;aj.sendString=sendString;aj.XMLHttpRequest.onreadystatechange=aj.processHandle;aj.resultHandle=resultHandle;aj.XMLHttpRequest.open("POST",targetUrl);aj.XMLHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");aj.XMLHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest");aj.XMLHttpRequest.send(aj.sendString)};return aj};