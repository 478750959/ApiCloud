function login(click,p_username,p_password){if(going)return;var name,pwd;if(click){name=$$("uid").value;pwd=$$("upass").value;if(""==name){uexWindow.toast("0","5","\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a\u6216\u7a7a\u683c\uff0c\u8bf7\u8f93\u5165\u8d26\u53f7",1500);return}if(""==pwd){uexWindow.toast("0","5","\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u8bf7\u8f93\u5165\u5bc6\u7801",1500);return}}else{name=p_username;pwd=p_password}var name2=encodeURIComponent(name);var pwd2=encodeURIComponent(pwd);var url=
login_url+"\x26mod\x3dlogging\x26action\x3dlogin\x26username\x3d"+name2+"\x26password\x3d"+pwd2;logs("login()--\x3eurl\x3d"+url);going=1;if(click)uexWindow.toast("1","5","\u767b\u5f55\u4e2d","");$.getJSON(url,function(json){logs("login--\x3ejson\x3d"+JSON.stringify(json));going=0;if(click)uexWindow.closeToast();if(json.status=="LoginSuccess"){json.username=name;json.password=pwd;onLogin(json,click);if(click){uexWindow.toast("0","5","\u767b\u9646\u6210\u529f",2E3);setTimeout("closewin(0, 'login');",
2500)}else closewin(0,"login")}else if(json.status=="member_notexist")uexWindow.toast("0","5","\u8d26\u53f7\u4e0d\u5b58\u5728",1500);else if(json.status=="password_error")uexWindow.toast("0","5","\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u70b9\u5fd8\u8bb0\u5bc6\u7801\uff0c\u91cd\u7f6e\u5bc6\u7801",1500);else uexWindow.toast("0","5","\u767b\u5f55\u5931\u8d25",1500)},"json",getJsonErr,"POST","","")}
function onLogin(json,click){var uid=json.uid;var name=json.username;var pwd=json.password;setstorage("UID",uid);setstorage("login_infor",'{"uname":"'+name+'","upwd":"'+pwd+'"}');save_login_info(uid,name,pwd);if(!isSML){var isPhone=window.navigator.platform!="Win32";var isAndroid=window.navigator.userAgent.indexOf("Android")>=0?true:false;var isiPhone=window.navigator.userAgent.indexOf("iPhone")>=0?true:false;var isiPad=window.navigator.userAgent.indexOf("iPad")>=0?true:false;if(isAndroid)sendAppInfo(appId,
uid,"2");else if(isiPhone||isiPad)sendAppInfo(appId,uid,"1");else sendAppInfo(appId,uid,"0")}setstorage("showimage"+uid,json.imagemode);setStorJson("role_status",json.rolemodule);uescript("root","loginsuccess("+click+");")}function save_login_info(uid,name,pwd){var obj=getStorJson("loginObj");if(!obj[uid])obj[uid]={"uid":uid};obj[uid].uname=name;obj[uid].upwd=pwd;setStorJson("loginObj",obj)};